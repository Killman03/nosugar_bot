import random
from typing import List

from config import settings


class MotivationService:
    """Service for providing motivational messages and advice."""
    
    def __init__(self):
        self.success_messages = [
            "ğŸ‰ ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°! Ğ¢Ñ‹ Ğ´ĞµÑ€Ğ¶Ğ¸ÑˆÑŒÑÑ ÑƒĞ¶Ğµ {} Ğ´Ğ½ĞµĞ¹!",
            "ğŸ”¥ ĞĞµĞ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾! Ğ¢Ğ²Ğ¾Ñ ÑĞ¸Ğ»Ğ° Ğ²Ğ¾Ğ»Ğ¸ Ğ²Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ»ÑĞµÑ‚!",
            "ğŸ’ª ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ±ĞµĞ· ÑĞ°Ñ…Ğ°Ñ€Ğ° - ÑÑ‚Ğ¾ Ğ¿Ğ¾Ğ±ĞµĞ´Ğ°!",
            "ğŸŒŸ Ğ¢Ñ‹ ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ÑˆÑŒÑÑ ÑĞ¸Ğ»ÑŒĞ½ĞµĞµ Ñ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¼ Ğ´Ğ½ĞµĞ¼!",
            "ğŸ† ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹ Ğ² Ñ‚Ğ¾Ğ¼ Ğ¶Ğµ Ğ´ÑƒÑ…Ğµ! Ğ¢Ñ‹ Ğ¼Ğ¾Ğ»Ğ¾Ğ´ĞµÑ†!",
            "âœ¨ Ğ¢Ğ²Ğ¾Ñ Ğ½Ğ°ÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚ÑŒ Ğ²Ğ´Ğ¾Ñ…Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚!",
            "ğŸ¯ Ğ•Ñ‰Ğµ Ğ¾Ğ´Ğ¸Ğ½ Ğ´ĞµĞ½ÑŒ Ğº Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ğ¶Ğ¸Ğ·Ğ½Ğ¸!",
            "ğŸ’ Ğ¢Ñ‹ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğ¹ Ğ°Ğ»Ğ¼Ğ°Ğ·! ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹ ÑĞ¸ÑÑ‚ÑŒ!"
        ]
        
        self.slip_up_messages = [
            "ğŸ˜” ĞĞµ Ğ¿ĞµÑ€ĞµĞ¶Ğ¸Ğ²Ğ°Ğ¹, ÑÑ€Ñ‹Ğ²Ñ‹ ÑĞ»ÑƒÑ‡Ğ°ÑÑ‚ÑÑ Ñƒ Ğ²ÑĞµÑ…. Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ - Ğ½Ğµ ÑĞ´Ğ°Ğ²Ğ°Ñ‚ÑŒÑÑ!",
            "ğŸ”„ Ğ—Ğ°Ğ²Ñ‚Ñ€Ğ° Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸!",
            "ğŸ’ª ĞĞ´Ğ¸Ğ½ ÑÑ€Ñ‹Ğ² Ğ½Ğµ Ğ¾Ñ‚Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ²ĞµÑÑŒ Ñ‚Ğ²Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ!",
            "ğŸŒŸ ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ° - ÑÑ‚Ğ¾ ÑƒÑ€Ğ¾Ğº. Ğ£Ñ‡Ğ¸ÑÑŒ Ğ¸ Ğ´Ğ²Ğ¸Ğ³Ğ°Ğ¹ÑÑ Ğ´Ğ°Ğ»ÑŒÑˆĞµ!",
            "ğŸ¯ ĞŸĞ¾Ğ¼Ğ½Ğ¸ Ğ¾ ÑĞ²Ğ¾ĞµĞ¹ Ñ†ĞµĞ»Ğ¸! Ğ¢Ñ‹ ÑĞ¸Ğ»ÑŒĞ½ĞµĞµ, Ñ‡ĞµĞ¼ Ğ´ÑƒĞ¼Ğ°ĞµÑˆÑŒ!",
            "ğŸ’ ĞĞ»Ğ¼Ğ°Ğ· Ñ‚Ğ¾Ğ¶Ğµ ÑˆĞ»Ğ¸Ñ„ÑƒĞµÑ‚ÑÑ Ğ½Ğµ ÑÑ€Ğ°Ğ·Ñƒ. ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ğ½Ğ°Ğ´ ÑĞ¾Ğ±Ğ¾Ğ¹!",
            "ğŸ”¥ ĞĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ Ğ¾Ğ³Ğ¾Ğ½ĞµĞº Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ñ€Ğ°Ğ·Ğ¶ĞµÑ‡ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ ĞºĞ¾ÑÑ‚ĞµÑ€ Ğ¼Ğ¾Ñ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ğ¸!",
            "âœ¨ ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ - ÑÑ‚Ğ¾ Ğ½Ğ¾Ğ²Ğ°Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑŒ Ğ»ÑƒÑ‡ÑˆĞµ!"
        ]
        
        self.daily_motivations = [
            "ğŸŒ… Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğµ ÑƒÑ‚Ñ€Ğ¾! Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ´Ğ»Ñ ÑƒĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ñ Ñ‚Ğ²Ğ¾ĞµĞ¹ ÑĞ¸Ğ»Ñ‹ Ğ²Ğ¾Ğ»Ğ¸!",
            "â˜€ï¸ ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ - Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸! Ğ¢Ñ‹ ÑĞ¿Ñ€Ğ°Ğ²Ğ¸ÑˆÑŒÑÑ!",
            "ğŸ’ª Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ñ‚Ñ‹ ÑÑ‚Ğ°Ğ½ĞµÑˆÑŒ ÑĞ¸Ğ»ÑŒĞ½ĞµĞµ, Ñ‡ĞµĞ¼ Ğ²Ñ‡ĞµÑ€Ğ°!",
            "ğŸ¯ ĞŸĞ¾Ğ¼Ğ½Ğ¸ Ğ¾ ÑĞ²Ğ¾ĞµĞ¹ Ñ†ĞµĞ»Ğ¸ - Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ¾Ğµ Ñ‚ĞµĞ»Ğ¾ Ğ¸ ÑÑĞ½Ñ‹Ğ¹ ÑƒĞ¼!",
            "ğŸŒŸ Ğ¢Ñ‹ Ğ½Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¿ÑƒÑ‚Ğ¸! ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ!",
            "ğŸ”¥ Ğ¢Ğ²Ğ¾Ñ Ñ€ĞµÑˆĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ·Ğ°Ğ¶Ğ¸Ğ³Ğ°ĞµÑ‚ Ğ¾Ğ³Ğ¾Ğ½ÑŒ Ğ² Ğ´Ñ€ÑƒĞ³Ğ¸Ñ…!",
            "ğŸ’ ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ±ĞµĞ· ÑĞ°Ñ…Ğ°Ñ€Ğ° Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ñ‚ĞµĞ±Ñ Ğ´Ñ€Ğ°Ğ³Ğ¾Ñ†ĞµĞ½Ğ½ĞµĞµ!",
            "âœ¨ Ğ¢Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°ĞµÑˆÑŒ Ğ»ÑƒÑ‡ÑˆĞµĞµ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞµ Ğ´Ğ»Ñ ÑĞµĞ±Ñ!"
        ]
        
        self.challenges = [
            "Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ¿ĞµĞ¹ Ñ‡Ğ°Ğ¹ Ğ±ĞµĞ· ÑĞ°Ñ…Ğ°Ñ€Ğ°",
            "Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸ ÑĞ»Ğ°Ğ´ĞºĞ¸Ğ¹ Ğ´ĞµÑĞµÑ€Ñ‚ Ğ½Ğ° Ñ„Ñ€ÑƒĞºÑ‚Ñ‹",
            "Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹ 10 Ğ¿Ñ€Ğ¸ÑĞµĞ´Ğ°Ğ½Ğ¸Ğ¹ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¿ĞµÑ€ĞµĞºÑƒÑĞ°",
            "Ğ’Ñ‹Ğ¿ĞµĞ¹ ÑÑ‚Ğ°ĞºĞ°Ğ½ Ğ²Ğ¾Ğ´Ñ‹ Ğ¿ĞµÑ€ĞµĞ´ ĞµĞ´Ğ¾Ğ¹",
            "ĞŸÑ€Ğ¾Ğ³ÑƒĞ»ÑĞ¹ÑÑ 15 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ½Ğ° ÑĞ²ĞµĞ¶ĞµĞ¼ Ğ²Ğ¾Ğ·Ğ´ÑƒÑ…Ğµ",
            "Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹ Ğ´Ñ‹Ñ…Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑƒĞ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ñ",
            "ĞŸÑ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑŒ Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğ¹ Ğ·Ğ°Ğ²Ñ‚Ñ€Ğ°Ğº",
            "ĞŸÑ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ¹ 10 ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ† ĞºĞ½Ğ¸Ğ³Ğ¸",
            "Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹ Ñ€Ğ°ÑÑ‚ÑĞ¶ĞºÑƒ ÑƒÑ‚Ñ€Ğ¾Ğ¼",
            "ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğ¹ Ñ€ĞµÑ†ĞµĞ¿Ñ‚"
        ]
    
    def get_success_message(self, streak_days: int) -> str:
        """Get a random success message with streak information."""
        message = random.choice(self.success_messages)
        return message.format(streak_days)
    
    def get_slip_up_message(self) -> str:
        """Get a random motivational message for slip-ups."""
        return random.choice(self.slip_up_messages)
    
    def get_daily_motivation(self) -> str:
        """Get a random daily motivation message."""
        return random.choice(self.daily_motivations)
    
    async def get_ai_motivation(self, streak_days: int) -> str:
        """Get AI-generated motivation message."""
        try:
            from services.ai_service import AIService
            ai_service = AIService()
            return await ai_service.generate_motivation(streak_days)
        except Exception as e:
            from loguru import logger
            logger.error(f"Error getting AI motivation: {e}")
            return self.get_daily_motivation()
    
    def get_random_challenge(self) -> str:
        """Get a random daily challenge."""
        return random.choice(self.challenges)
    
    def get_payment_reminder(self) -> str:
        """Get payment reminder message."""
        return (
            "ğŸ’¸ ĞĞ¹! ĞŸĞ¾Ñ…Ğ¾Ğ¶Ğµ, Ñ‚Ñ‹ ÑĞ¾Ñ€Ğ²Ğ°Ğ»ÑÑ! ğŸ˜…\n\n"
            "Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ Ğ½Ğ°ÑˆĞ¸Ğ¼ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼, Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑĞºĞ¸Ğ½ÑƒÑ‚ÑŒ 50 ÑĞ¾Ğ¼ Ğ½Ğ° Ğ½Ğ¾Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚Ñ‹:\n"
            f"ğŸ’³ {settings.payment_card_number}\n\n"
            "Ğ­Ñ‚Ğ¾ Ğ¿Ğ¾Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ñ‚ĞµĞ±Ğµ Ğ»ÑƒÑ‡ÑˆĞµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµĞ±Ñ Ğ² ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ñ€Ğ°Ğ·! ğŸ˜‰"
        )
    
    def get_streak_celebration(self, streak_days: int) -> str:
        """Get celebration message for milestone streaks."""
        if streak_days == 7:
            return "ğŸ‰ ĞĞµĞ´ĞµĞ»Ñ Ğ±ĞµĞ· ÑĞ°Ñ…Ğ°Ñ€Ğ°! Ğ¢Ñ‹ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğ¹ Ğ³ĞµÑ€Ğ¾Ğ¹! ğŸŒŸ"
        elif streak_days == 30:
            return "ğŸ† ĞœĞµÑÑÑ† Ğ±ĞµĞ· ÑĞ°Ñ…Ğ°Ñ€Ğ°! Ğ¢Ñ‹ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³ Ğ½ĞµĞ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°! ğŸ’"
        elif streak_days == 100:
            return "ğŸ‘‘ 100 Ğ´Ğ½ĞµĞ¹! Ğ¢Ñ‹ ĞºĞ¾Ñ€Ğ¾Ğ»ÑŒ/ĞºĞ¾Ñ€Ğ¾Ğ»ĞµĞ²Ğ° ÑĞ¸Ğ»Ñ‹ Ğ²Ğ¾Ğ»Ğ¸! ğŸ‘‘"
        elif streak_days % 7 == 0:
            return f"ğŸŠ {streak_days} Ğ´Ğ½ĞµĞ¹! ĞšĞ°Ğ¶Ğ´ÑƒÑ Ğ½ĞµĞ´ĞµĞ»Ñ Ñ‚Ñ‹ ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ÑˆÑŒÑÑ ÑĞ¸Ğ»ÑŒĞ½ĞµĞµ! ğŸ’ª"
        else:
            return self.get_success_message(streak_days) 